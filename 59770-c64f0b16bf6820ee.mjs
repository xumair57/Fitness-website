"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[59770,18755],{835157:(e,t,a)=>{a.d(t,{Z:()=>r});var s=a(383399);let r=()=>{let e=(0,s.Z)();return!!e.isAuth&&e.isPartner}},53608:(e,t,a)=>{a.d(t,{FE:()=>$,lG:()=>U,d9:()=>R});var s=a(667294),r=a(616550),n=a(835157),i=a(957583),u=a(297728),l=a(383399),c=a(415787);let d=()=>{let e=(0,l.Z)(),{checkExperiment:t}=(0,u.F)(),a=(0,n.Z)()&&t("web_m10n_business_reporting_business_entity_service").anyEnabled,[r,d]=(0,s.useState)({isReady:!1}),o=(0,s.useCallback)(async({entityId:e,actingBusinessId:t,favorites:s})=>{a&&(await (0,i.yo)({entityId:e,actingBusinessId:t,favorites:s}),d(e=>{let a={...e,actingBusinessId:t};return s&&(a.favoriteAdAccounts={favoriteAdAccountsMap:{...e.favoriteAdAccounts?.favoriteAdAccountsMap||{},[s.actingBusinessId]:{advertiserId:s.adAccounts}}}),a}))},[a]);return(0,s.useEffect)(()=>{a&&e.isAuth&&!r.isReady&&(async()=>{let t=!1;try{let t=await (0,i.SF)({entityId:e.id});d(e=>({...e,...t}))}catch{t=!0}finally{(0,c.nP)("globalAccountSwitcher.getFavoriteAdAccounts",{sampleRate:1,tags:{businessId:e.id,hasError:t}}),d(e=>({...e,isReady:!0}))}})()},[r.isReady,a,e]),{accountSwitcherConfig:r,setConfig:o}};var o=a(545007),m=a(366513),_=a(442279),p=a(689567);let A=(0,_.P1)(p.Z,({viewerIsProfileOwnerOrProfileManager:e})=>e??void 0);var g=a(501912),S=a(801621),f=a(467403);let E=()=>{let e=(0,l.Z)(),t=(0,s.useRef)(e);t.current=e;let a=(0,o.I0)(),r=(0,g.Z)(),n=(0,s.useRef)(r);n.current=r;let u=(0,o.v9)(A),c=u?.data||void 0,d=(0,s.useRef)(c);d.current=c,(0,s.useEffect)(()=>{(async()=>{if(t.current.isAuth&&void 0===u.data){let e=await (0,i.bG)({user_id:t.current.id});if(void 0!==e&&void 0===d.current){let s=(0,S.D3)(t.current,e?.id??"",n)||t.current.isAuth&&t.current.username===e?.username;a((0,m.Z)(!!s))}}})()},[t,d,a,n,u]);let _=(0,f.rc)(c);return{viewerIsProfileOwnerOrProfileManagerData:c,previousIsViewerProfileOwnerOrProfileManager:_}};var h=a(200892),y=a(573706),I=a(498490),C=a(282999),N=a(812477),O=a(868808),b=a(668868),v=a(553740),T=a(785893);let{Provider:w,useHook:R}=(0,I.Z)("AccountSwitcherContext"),U=e=>e.search&&(0,O.mB)(e.search).advertiserId,$=({children:e})=>{let t=(0,r.TH)(),{params:{userBizId:a,businessHierarchyId:c,advertiserId:o,username:m}}=(0,r.$B)(),{catalogId:_}=(0,v.Z)(),p=U(t),A=(0,l.Z)(),{viewerIsProfileOwnerOrProfileManagerData:g,previousIsViewerProfileOwnerOrProfileManager:S}=E(),{checkExperiment:I}=(0,u.F)(),O=I("web_m10n_business_access_catalogs").anyEnabled,[R,$]=(0,s.useState)(""),[B,D]=(0,s.useState)(null),[L,P]=(0,s.useState)(!1),[Z,H]=(0,s.useState)(null),F=new URLSearchParams(t.search),[M,G]=(0,s.useState)(F.has("actingBusinessId")?null:{id:A.id||"",name:A.fullName||"",img:A.imageMediumUrl||""}),[k,z]=(0,s.useState)(!1),x=(0,n.Z)(),{logContextEvent:V}=(0,y.v)(),{accountSwitcherConfig:W,setConfig:Y}=d();(0,s.useEffect)(()=>{c?$(c):$("")},[c]);let j=(0,s.useCallback)(async({id:e,username:t})=>{let a=await (0,i.bG)({user_id:e,username:t});a&&H({type:e?h.Oz.BUSINESS_ACCOUNT:h.Oz.PROFILE,id:e||a.id,name:a.full_name,img:a.image_medium_url,username:t,ownerImg:a.image_medium_url,ownerName:a.full_name,actingBusinessFullName:M?.name||a.full_name}),z(!1)},[M]),q=(0,f.rc)(m);(0,s.useEffect)(()=>{(0,N.Z)(t)&&Z&&q!==m&&m===A.username&&(j({username:A.username}),G({id:A.id||"",name:A.fullName||"",img:A.imageMediumUrl||""}),D({type:h.nt,id:A.id}))},[t,q,j,Z,m,A.fullName,A.id,A.imageMediumUrl,A.username]),(0,s.useEffect)(()=>{let e=async({businessId:e,assetId:a})=>{if(!e){z(!1);return}let s=O&&(0,C.Bg)(t)?"CATALOG":"AD_ACCOUNT";try{let e={asset:{name:""},type:s};if(A.isAuth){let{data:{data:t={[a]:e}}={}}=await (0,b.pI)({businessId:M?.id||A.id,assetIds:[a],resourceType:s})||{},{asset:r,type:n}=t[a]||e;H({id:a,name:"CATALOG"===s?t[a].owner.full_name:r.name,img:t[a].owner.image_medium_url,type:n,ownerImg:t[a].owner.image_medium_url,ownerName:t[a].owner.full_name,actingBusinessFullName:M?.name||t[a].owner.full_name})}}catch{H({id:A.id||"",name:A.fullName||"",img:A.imageMediumUrl||"",type:h.Oz.BUSINESS_ACCOUNT,ownerImg:A.imageMediumUrl||"",ownerName:A.fullName||"",actingBusinessFullName:A.fullName||""})}z(!1)},s=async({id:e})=>{let t=await (0,i.p)({hierarchyId:e});H({id:e,name:t?.data?t.data.name:"",img:t?.data?t.data.img_medium_url:"",type:h.Oz.BUSINESS_HIERARCHY,ownerImg:t?.data?t.data.img_medium_url:"",ownerName:t?.data?t.data.name:"",actingBusinessFullName:t?.data?t.data.name:""}),z(!1)};if(A.isAuth&&x){let r=Z&&Z.username&&Z.username!==m,n=!0===g&&g!==S;if((!Z||r||n)&&!k&&M){let r=(0,C.z6)(t)||(0,C.h3)(t),n=o||!!p&&!r||(0,C.Bg)(t)&&O;z(!0),c?s({id:c}):a?j({id:a}):(0,N.Z)(t)&&m&&g?j({username:m}):n?e({businessId:A.id,assetId:o||p||_||""}):Z&&Z.id===A.id||(H({type:h.Oz.BUSINESS_ACCOUNT,id:A.id||"",name:A.fullName||"",img:A.imageMediumUrl||"",ownerImg:A.imageMediumUrl||"",ownerName:A.fullName||"",actingBusinessFullName:A.fullName||""}),z(!1))}}},[Z,A,c,a,m,o,p,M,x,t,j,k,g,S,_,O]);let X=(0,s.useMemo)(()=>({activePanel:B,selectedHierarchyId:R,switcherOpen:L,openAccountSwitcher:()=>{if(V({event_type:101,view_type:608,component:14346}),!B){if((0,C.z6)(t))D({type:h.v8});else{let e=new URLSearchParams(t.search).get("actingBusinessId");D({type:h.nt,id:e??M?.id})}}P(!0)},closeAccountSwitcher:()=>{D(Z&&!(0,C.z6)(t)?{type:h.nt,id:M?.id}:{type:h.v8}),P(!1)},openAssetPanel:e=>{D({type:h.nt,id:e})},closeAssetPanel:()=>{D(Z&&!(0,C.z6)(t)?{type:h.nt,id:M?.id}:{type:h.v8})},activateBusinessPanel:()=>{D({type:h.v8})},actingBusiness:M,selectedAccount:Z,setSelectedAccount:H,setActingBusiness:G,accountSwitcherConfig:W,setConfig:Y}),[B,R,L,M,Z,W,Y,V,t]);return/*#__PURE__*/(0,T.jsx)(w,{value:X,children:e})}},252025:(e,t,a)=>{a.d(t,{C:()=>S,H:()=>f});var s=a(667294),r=a(835157),n=a(200892),i=a(957583),u=a(449112),l=a(909015),c=a(591769),d=a(498490),o=a(400416),m=a(697254),_=a(383399),p=a(697843),A=a(785893);let{Provider:g,useHook:S}=(0,d.Z)("BusinessHierarchyContext"),f=({children:e})=>{let[t,a]=(0,s.useState)([]),[d,S]=(0,s.useState)([]),[f,E]=(0,s.useState)(!1),[h,y]=(0,s.useState)(!1),[I,C]=(0,s.useState)({}),[N,O]=(0,s.useState)(null),[b,v]=(0,s.useState)([]),[T,w]=(0,s.useState)({}),R=(0,p.Z)(),U=(0,s.useRef)(R),$=(0,_.Z)(),B=(0,r.Z)(),D=(0,s.useRef)({}),L=(0,s.useCallback)((e,t)=>{let a;t===n.Oz.BUSINESS_HIERARCHY?a=(0,c.Z)(l.Q6.DASHBOARD,"","",e):t===n.Oz.BUSINESS_ACCOUNT&&(a=(0,c.Z)(l.Q6.DASHBOARD,e));let s=(0,m.Z)({site:"www",path:a});(0,u.Z)(s)},[]),P=(0,s.useCallback)(async e=>{if(!B)return[];if(y(!0),D.current[e])return y(!1),D.current[e];{let{data:t}=(await (0,o.Z)({url:"ads/v4/business_access/business_hierarchies/",data:{search_by:["FULL_NAME","BUSINESS_ID"],search_value:e}})).resource_response,a=t&&t.map(e=>(e.children&&(e.children=e.children.map(e=>(e.user.entity_type=n.Oz.USER_ACCOUNT,e))),e))||[],s=/^\d+$/.test(e),r=RegExp(e.toLowerCase(),"g"),u=[];N||O(u=await U.current());let l=(N??u).filter(t=>s?t.id.includes(e):t.user.full_name.toLowerCase().match(r)).map(i.IT),c=[...a.map(e=>e.id),...l.map(e=>e.id)],d=s?($.id||"").includes(e):($.fullName||"").toLowerCase().match(r);return $.isAuth&&d&&c.push($.id),D.current[e]=c,y(!1),c}},[B,U,$.id,$.fullName,$.isAuth,N]),{id:Z="",username:H="",email:F="",fullName:M="",imageSmallUrl:G="",imageMediumUrl:k="",isAuth:z}=$,x=async(e,t)=>{if((!z||!B||N)&&!e)return;E(!0);let s=[];try{let{data:e}=(await (0,o.Z)({url:"ads/v4/business_access/business_hierarchies/"})).resource_response;s=e&&e.map(e=>(e.children&&(e.children=e.children.map(e=>(e.user.entity_type=n.Oz.USER_ACCOUNT,e))),e))||[],a(s)}catch{a([])}try{let a=[];(!N||e)&&(a=await U.current(),S(a.filter(e=>t&&N&&!N.some(({id:t})=>t===e.id)).map(e=>e.user.full_name)),O(a));let r=e?a:N??a;v(r.map(i.IT)),w(r.reduce((e,t)=>(e[t.id]=t.business_roles||[],e),{})),C((0,i.WP)({id:Z,username:H,email:F,fullName:M,imageSmallUrl:G,imageMediumUrl:k})),D.current[""]=[...s.map(e=>e.id),...r.map(i.IT).map(e=>e.id),Z],E(!1)}catch{E(!1)}},V=(0,s.useCallback)(x,[Z,H,F,M,G,k,z,B,N]),W=(0,s.useCallback)(e=>t.some(t=>t.id===e||t.children.some(t=>t.id===e||t.user.id===e)),[t]),Y=(0,s.useCallback)(e=>t.map(e=>"BUSINESS_HIERARCHY"===e.entity_type?e:null).find(t=>!!t&&t.children.some(t=>t.user.id===e)),[t]),j=(0,s.useCallback)(()=>{S([])},[S]),q=(0,s.useMemo)(()=>({businessHierarchies:[...I.id&&!W(I.id)?[I]:[],...t,...b.filter(e=>!W(e.id))],switchAccount:L,searchAccounts:P,loadingAccounts:f,isSearchingAccounts:h,fetchData:V,getParentHierarchyForIdIfExists:Y,viewerRolesOfEachEmployer:T,tooltipEmployers:d,hideTooltip:j}),[t,L,P,b,f,h,I,V,W,Y,T,d,j]);return/*#__PURE__*/(0,A.jsx)(g,{value:q,children:e})}},957583:(e,t,a)=>{a.d(t,{IT:()=>c,SF:()=>_,Vq:()=>l,WP:()=>d,bG:()=>m,p:()=>o,yo:()=>p});var s=a(139573),r=a(252071),n=a(200892),i=a(400416),u=a(719641);let l=e=>({id:e.id,entity_type:n.Oz.BUSINESS_ACCOUNT,user:{id:e.user.id,entity_type:n.Oz.USER_ACCOUNT,username:e.user.username,email:e.user.email,full_name:e.user.full_name,image_small_url:e.user.image_small_url,image_medium_url:e.user.image_medium_url}}),c=e=>({id:e.id,entity_type:n.Oz.BUSINESS_ACCOUNT,requires_mfa_for_roles:e.requires_mfa_for_roles,user:{id:e.user.id,entity_type:n.Oz.USER_ACCOUNT,username:e.user.username,email:e.user.email,full_name:e.user.full_name,image_small_url:e.user.image_small_url,image_medium_url:e.user.image_medium_url}}),d=e=>({id:e.id,entity_type:n.Oz.BUSINESS_ACCOUNT,user:{id:e.id,entity_type:n.Oz.USER_ACCOUNT,username:e.username,email:e.email,full_name:e.fullName,image_small_url:e.imageSmallUrl,image_medium_url:e.imageMediumUrl}}),o=async({hierarchyId:e})=>(await (0,i.Z)({url:`ads/v4/business_access/business_hierarchy/${e}/`})).resource_response,m=async({user_id:e,username:t})=>{if(!t&&!e)return null;let{resource_response:{data:a}}=await r.Z.create("UserResource",{user_id:e,username:t}).callGet();return a},_=async({entityId:e})=>{let t=(await (0,s.FO)([{entity_type:"BIZ_USER",entity_id:e,property_keys:["GLOBAL_ACCOUNT_SWITCHER_CONFIG"]}]))[0];return t&&t.properties?t.properties.GLOBAL_ACCOUNT_SWITCHER_CONFIG:{}},p=async({entityId:e,actingBusinessId:t,favorites:a})=>{let r={};(0,u.k)(t)||(r.actingBusinessId=t),a&&(r.favoriteAdAccounts={favoriteAdAccountsMap:{[a.actingBusinessId]:{advertiserId:a.adAccounts}}}),Object.keys(r).length>0&&await (0,s.RM)([{entity_type:"BIZ_USER",entity_id:e,properties:{GLOBAL_ACCOUNT_SWITCHER_CONFIG:r}}])}},118755:(e,t,a)=>{a.d(t,{G6:()=>n,i7:()=>i,oi:()=>s,u$:()=>r,un:()=>l,vU:()=>u,w1:()=>c});let s=Object.freeze({OTHER:0,CHROME:1,SAFARI:2,IE:3,FIREFOX:4,OPERA:5,EDGE:6}),r=e=>e?e.includes("Chrome")?s.CHROME:e.includes("Safari")?s.SAFARI:e.includes("Firefox")?s.FIREFOX:e.includes("Opera")?s.OPERA:e.includes("IE")?s.IE:e.includes("Edge")?s.EDGE:s.OTHER:s.OTHER;function n(e){return r(e)===s.SAFARI}function i(e){return r(e)===s.CHROME}function u(e){return r(e)===s.FIREFOX}function l(e){return r(e)===s.EDGE}function c(e){return r(e)===s.IE}},591769:(e,t,a)=>{a.d(t,{Z:()=>n});let s="/business/business-manager/",r="/business/business-hierarchy/",n=(e,t,a,n)=>{switch(e){case"DASHBOARD":return n?`${r}${String(n)}/dashboard/`:`${s}${String(t)}/dashboard/`;case"PEOPLE":return`${s}${String(t)}/employees/`;case"PARTNERS":return`${s}${String(t)}/partners/`;case"AD_ACCOUNTS":return`${s}${String(t)}/ad-accounts/`;case"HISTORY":return`${s}${String(t)}/history/`;case"PEOPLE_DETAIL":return`${s}${String(t)}/employees/${String(a)}/details/`;case"PARTNERS_DETAIL":return`${s}${String(t)}/partners/${String(a)}/details/`;case"SHARED_PARTNERS_DETAIL":return`${s}${String(t)}/shared/${String(a)}/details/`;case"AD_ACCOUNTS_DETAIL":return`${s}${String(t)}/ad-accounts/${String(a)}/details/`;case"PENDING_AD_ACCOUNTS_DETAIL":return`${s}${String(t)}/ad-accounts/pending/${String(a)}/details/`;case"PEOPLE_PENDING_TAB":return`${s}${String(t)}/employees/pending/`;case"PARTNERS_PENDING_TAB":return`${s}${String(t)}/partners/pending/`;case"AD_ACCOUNTS_PENDING_TAB":return`${s}${String(t)}/ad-accounts/pending`;case"AD_ACCOUNTS_CEE_MIGRATION":return`${s}${String(t)}/ad-accounts/cee-migration`;case"PROFILES":return`${s}${String(t)}/profiles/`;case"PROFILES_DETAIL":return`${s}${String(t)}/profiles/${String(a)}/details/`;case"BUSINESS_SECURITY":return`${s}${String(t)}/security/`;case"ASSET_GROUPS":return a?`${s}${String(t)}/asset-groups/?asset_group_id=${String(a)}`:`${s}${String(t)}/asset-groups/`;case"INVOICE_MANAGEMENT":return`${s}${String(t)}/invoice-management/`;case"BUSINESS_HIERARCHY":return`${r}${String(n)}/hierarchy/`;case"BUSINESS_HIERARCHY_BUSINESS_SECURITY":return`${r}${String(n)}/business_security/`;case"MANAGERS":return`${r}${String(n)}/managers/`;case"AUDIENCES":return`${s}${String(t)}/audiences/`;case"SHARED_TAGS":return`${s}${String(t)}/shared-tags/`;case"CATALOGS":return`${s}${String(t)}/catalogs/`;case"BRAND_SAFETY":return`${s}${String(t)}/brand-safety/`;case"BUSINESS_SETTINGS":return`${s}${String(t)}/settings/`;default:return s}}},777396:(e,t,a)=>{a.d(t,{Z:()=>r});var s=a(566344);let r=()=>{let{hostname:e}=window.location,t=e.includes("pinterdev")&&!e.includes("ads.pinterdev"),a=e.includes("pinterest")&&(e.startsWith("www")||e.startsWith("latest")||e.startsWith("testing"));return t||a?e:e.includes("ads-latest")?"latest.pinterest.com":s.Vi}},812477:(e,t,a)=>{a.d(t,{Z:()=>n,c:()=>i});var s=a(616550);let r=["/BingSiteAuth.xml","/about","/add-account","/ads","/ads.txt","/age_verification","/all","/app-ads.txt","/apple-app-site-association","/apple-app-site-association.p7m","/attribution_source","/bot.html","/branded-pins","/browserbutton","/buy-it","/careers","/categories","/close-account","/content-claiming","/convert-business","/convert-personal","/create-business","/create-personal","/creation-inspiration","/creator-onboarding-landing","/csrf_error","/ct.html","/deactivate-account","/deed6a3ef3a44d41bb3ae2bad137db84.txt","/developers","/discover","/edit","/email_verification_error","/engagement","/explore","/favicon.ico","/fb.html","/flyup-instant-loading-indicator-app-shell.html","/following","/getWebPushKey","/google_gdn.html","/google_search.html","/googlef5dc42d6e03f6e61.html","/guidedsearch","/help","/holidays-celebrations","/homefeed","/idea-ads-tool","/idea-pin-builder","/ideas","/inbox","/install-shuffles","/invited","/jobs","/lens-search","/login","/logout","/manifest.json","/manifest.webapp","/me","/messages","/mobile","/notifications","/oauth","/app-factory-oauth","/appealed-pin","/oembed.json","/offline.html","/offsite","/opensearch.xml","/parent_contact_info","/parental-passcode","/pin-builder","/pin-creation-tool","/pin-editor","/pin_catalog","/pin_redirect","/pinterest-wellbeing","/pinterest-predicts","/pinterestlens","/pinterestlenstryon","/pinterestwellbeing","/policy","/product-catalogs","/public-beta","/quick-instant-loading-indicator-app-shell.html","/quick-lite-instant-loading-indicator-app-shell.html","/recently-viewed","/refresh_stored_accounts","/refresh_token","/report","/reports-and-violations","/request-data","/robots.txt","/safe-redirect","/search","/settings","/shopping","/signup","/socialmanager","/story-pin-builder","/story_feed","/sw-shell.html","/sw.html","/sw.js","/switch_account","/terms","/today","/topics","/transparent.html","/unauth-profile","/unlink","/upload-image","/upload-image-lens-history","/upload-lens-image","/upload-profile-image","/verified","/verify","/videos","/web-custom-svg","/web-mentorship","/welcome","/windows-app-web-link","/your-shop"];function n(e){return!!(0,s.LX)(e.pathname,{path:"/:username/",exact:!0})&&!r.includes(e.pathname.replace(/\/$/,""))}function i(e){return!!(0,s.LX)(e.pathname,{path:"/:username/_created/",exact:!0})}},697843:(e,t,a)=>{a.d(t,{Z:()=>r});var s=a(400416);function r(){return async()=>{let e=await (0,s.Z)({url:"/ads/v4/business_access/businesses/me/employers/"}),t=e.resource_response?e.resource_response.data:{data:[]};return await Promise.all(t&&t.data||[])}}},366513:(e,t,a)=>{a.d(t,{Z:()=>s});function s(e){return{type:"UPDATE_VIEWER_IS_PROFILE_OWNER_OR_PROFILE_MANAGER",payload:e}}},689567:(e,t,a)=>{a.d(t,{Z:()=>s});let s=({businessAccess:e})=>e??{}},553740:(e,t,a)=>{a.d(t,{Z:()=>r});var s=a(616550);function r(){let{catalog_id:e,feed_profile_id:t,workflow_id:a,product_group_id:r,event_type_id:n,supplemental_feed_profile_id:i}=(0,s.UO)();return{catalogId:e,feedProfileId:t,workflowId:a,productGroupId:r,eventTypeId:n,supplementalFeedProfileId:i}}},555923:(e,t,a)=>{a.d(t,{I:()=>C,a:()=>y});var s=a(667294),r=a(616550),n=a(957583),i=a(277516),u=a(498490),l=a(297728),c=a(383399),d=a(400416);let o=async()=>(await (0,d.Z)({url:"ads/v4/pinterest_support_managed_advertisers",data:{add_fields:"advertiser.owner_user()"}})).resource_response;var m=a(978993);let _=e=>[...e.map(e=>({id:e.business.id,ownedAndManagedAdAccounts:e.business.ad_account_count,user:e.business.pinterest_support_business,managedAdAccounts:e.advertisers.reduce((e,t)=>e.set(t.id,t),new Map)}))].sort(({user:{username:e}},{user:{username:t}})=>e.localeCompare(t)).map(e=>{let t=[...e.managedAdAccounts.values()].sort(({name:e},{name:t})=>e.localeCompare(t));return e.managedAdAccounts=t.reduce((e,t)=>e.set(t.id,t),new Map),e}).reduce((e,t)=>e.set(t.id,t),new Map),p={managedBusinessesMap:new Map,headerVisible:!1,activeAdAccount:{clientId:void 0,adAccountId:void 0},fetching:!1,error:!1},A=(e,t)=>{switch(t.type){case"LOAD_AD_ACCOUNTS":return{...e,managedBusinessesMap:t.payload.managedBusinesses};case"SET_ACTIVE_CLIENT":case"SET_ACTIVE_AD_ACCOUNT":return{...e,activeAdAccount:t.payload};case"TOGGLE_HEADER_VISIBILITY":return{...e,headerVisible:t.payload};default:return e}},g=({dispatch:e,isEnabled:t,state:a})=>{let{headerVisible:r}=a;return{changeClient:(0,s.useCallback)(a=>{t&&e({type:"SET_ACTIVE_CLIENT",payload:{clientId:a,adAccountId:null}})},[t,e]),changeAdAccount:(0,s.useCallback)((a,s)=>{t&&e({type:"SET_ACTIVE_AD_ACCOUNT",payload:{adAccountId:a,clientId:s}})},[t,e]),toggleHeaderVisibility:(0,s.useCallback)(a=>{t&&e({type:"TOGGLE_HEADER_VISIBILITY",payload:a??!r})},[t,e,r])}},S=e=>{let[t,a]=(0,s.useReducer)(A,p),r=g({dispatch:a,isEnabled:e,state:t}),{activeAdAccount:n}=t;return(0,s.useEffect)(()=>{let e=JSON.parse((0,m.qn)("psToolAdAccount",!1));e&&a({type:"SET_ACTIVE_AD_ACCOUNT",payload:e})},[]),(0,s.useEffect)(()=>{(0,m.Nh)("psToolAdAccount",JSON.stringify(n))},[n]),{state:t,actions:r,receiveAdAccounts:(0,s.useCallback)(e=>{a({type:"LOAD_AD_ACCOUNTS",payload:{managedBusinesses:_(e)}})},[a])}},f=()=>{let{checkExperiment:e}=(0,l.F)(),t=(0,c.Z)(),{state:a,receiveAdAccounts:r}=S(!!(t.isAuth&&t.isPartner&&e("web_m10n_pin_support_tool").anyEnabled)),{managedBusinessesMap:n,error:i,fetching:u}=a,d=!!i||n.size>0,m=(0,s.useCallback)(async()=>{let e=await o();r(e?.data??[])},[r]);return(0,s.useEffect)(()=>{d||u||m()},[m,d,u]),n};var E=a(785893);let{Provider:h,useMaybeHook:y}=(0,u.Z)("PinSupportToolContext"),I=()=>{let{search:e}=(0,r.TH)();return(0,s.useMemo)(()=>new URLSearchParams(e),[e])},C=({children:e,viewerAdvertiser:t})=>{let{checkExperiment:a}=(0,l.F)(),r=(0,c.Z)(),u=r.isAuth&&r.isPartner&&a("web_m10n_pin_support_tool").anyEnabled,{state:d,actions:o}=S(u),m=f(),_=[...m.values()].map(e=>(0,n.Vq)(e)),{sterling_on_steroids_ldap:p}=(0,i.u)(),{activeAdAccount:A,headerVisible:g}=d,y=r.isAuth&&!!p,{changeClient:C,changeAdAccount:N,toggleHeaderVisibility:O}=o;(0,s.useEffect)(()=>{u&&(y&&!g&&O(!0),!y&&g&&O(!1))},[O,y,u,g]);let b=I(),v=b.get("managedClientId"),T=b.get("advertiserId")||t?.id;(0,s.useEffect)(()=>{v&&T?N(T,v):v&&C(v)},[C,N,v,T]);let w=m.get(A?.clientId||""),R=(w?.managedAdAccounts||new Map).get(A?.adAccountId||""),U=[...m.values()];return/*#__PURE__*/(0,E.jsx)(h,{value:{managedBusinesses:U,managedBusinessAccounts:_,headerVisible:d.headerVisible,activeClient:w,activeAdAccount:R,viewerAdvertiser:t,changeClient:C,changeAdAccount:N,toggleHeaderVisibility:O},children:e})}},605935:(e,t,a)=>{a.d(t,{Z:()=>o,f:()=>d});var s=a(667294),r=a(400416),n=a(297728),i=a(730212),u=a(319453);let l="ADVERTISER",c=(e,t)=>e&&e[t]&&e[t][0]&&e[t][0].preferences,d=async e=>{let t;try{let a=(await (0,r.Z)({method:"GET",url:`/ads/v4/preferences/${e}/`,data:{level:l,key:"CAMPAIGN_TOOL_PREFERENCE"}})).resource_response.data;t=c(a,l)}catch{return null}return t&&(0,u.TT)(t)?t:null},o=()=>{let[e,t]=(0,s.useState)(null),a=(0,n.F)(),{advertiser:r}=(0,i.B)();return(0,s.useEffect)(()=>{(0,u.UM)(a,{skipActivation:!0})&&(async()=>{r&&t(await d(r.id))})()},[r,a]),e}},424583:(e,t,a)=>{a.d(t,{Tt:()=>o,cm:()=>d,kW:()=>l,kY:()=>m,mN:()=>c});var s=a(545007),r=a(498490),n=a(383399),i=a(785893);let{Provider:u,useHook:l}=(0,r.Z)("Users");function c(){let e=l();return t=>e[t]}function d(){let e=l();return(t,a=!1)=>{let s=Object.keys(e).find(a=>e[a].username===t);if(s||!a)return e[s??""]}}function o(){let{id:e}=(0,n.Z)();return l()[e??""]}function m({children:e}){let t=(0,s.v9)(({users:e})=>e,s.wU);return/*#__PURE__*/(0,i.jsx)(u,{value:t,children:e})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/59770-c64f0b16bf6820ee.mjs.map